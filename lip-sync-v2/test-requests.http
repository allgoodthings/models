### Lip-Sync V2 API Test Requests
### Uses Wav2Lip + GFPGAN (simpler than v1's MuseTalk/LivePortrait stack)

### Base URL - Update to your deployment
@baseUrl = https://h0j2bzv0ewfg0w-8000.proxy.runpod.net

### Test Assets
@refImage = https://replicate.delivery/pbxt/MNRKHnYUu5HjNqEerj2kxWRmUD3xWGaZ0gJmhqVbkra2jCbD/underwater.jpeg
@videoUrl = https://replicate.delivery/czjl/xFIwsxPXTtpCHJw2WqLH3gqACg3csLVVdKtbLf1heBzXiUJUA/tmp35xuh600.mp4
@audioUrl = https://replicate.delivery/pbxt/Nl3OAXz8mkiA0KFCoL1m7d6hWdrEGlXjN3hLFPpM7giMlvwi/every-person.mp3

### =============================================================================
### Health Check
### =============================================================================
GET {{baseUrl}}/health

### =============================================================================
### Root - List Endpoints
### =============================================================================
GET {{baseUrl}}/

### =============================================================================
### Face Tracking (Visual Validation)
### Generates a video with bounding boxes to verify face detection
### Use this to validate detection before running full lip-sync
### =============================================================================
# @timeout 120000
POST {{baseUrl}}/face-tracking
Content-Type: application/json

{
  "video_url": "{{videoUrl}}",
  "upload_url": "YOUR_PRESIGNED_UPLOAD_URL",
  "characters": [
    {
      "id": "speaker",
      "name": "Speaker",
      "reference_image_url": "{{refImage}}"
    }
  ],
  "similarity_threshold": 0.5,
  "temporal_smoothing": 0.3
}

### =============================================================================
### Lip-Sync (Full Pipeline) - Crossfade Loop (Default)
### Wav2Lip + GFPGAN + Poisson blending + crossfade at loop boundaries
### =============================================================================
# @timeout 300000
POST {{baseUrl}}/lipsync
Content-Type: application/json

{
  "video_url": "{{videoUrl}}",
  "audio_url": "{{audioUrl}}",
  "upload_url": "YOUR_PRESIGNED_UPLOAD_URL",
  "characters": [
    {
      "id": "speaker",
      "name": "Speaker",
      "reference_image_url": "{{refImage}}"
    }
  ],
  "similarity_threshold": 0.5,
  "enhance_quality": true,
  "loop_mode": "crossfade",
  "crossfade_frames": 10,
  "temporal_smoothing": 0.3
}

### =============================================================================
### Lip-Sync - No Loop (Trim to Shortest)
### Good for action films where looping doesn't make sense
### =============================================================================
# @timeout 300000
POST {{baseUrl}}/lipsync
Content-Type: application/json

{
  "video_url": "{{videoUrl}}",
  "audio_url": "{{audioUrl}}",
  "upload_url": "YOUR_PRESIGNED_UPLOAD_URL",
  "characters": [
    {
      "id": "speaker",
      "name": "Speaker",
      "reference_image_url": "{{refImage}}"
    }
  ],
  "similarity_threshold": 0.5,
  "enhance_quality": true,
  "loop_mode": "none",
  "temporal_smoothing": 0.3
}

### =============================================================================
### Lip-Sync - Ping-Pong Loop
### Forward-backward oscillation - good for portraits/talking heads
### =============================================================================
# @timeout 300000
POST {{baseUrl}}/lipsync
Content-Type: application/json

{
  "video_url": "{{videoUrl}}",
  "audio_url": "{{audioUrl}}",
  "upload_url": "YOUR_PRESIGNED_UPLOAD_URL",
  "characters": [
    {
      "id": "speaker",
      "name": "Speaker",
      "reference_image_url": "{{refImage}}"
    }
  ],
  "similarity_threshold": 0.5,
  "enhance_quality": true,
  "loop_mode": "pingpong",
  "temporal_smoothing": 0.3
}

### =============================================================================
### Lip-Sync - Hard Repeat Loop
### Simple modulo wrap (may have visible jump at loop point)
### =============================================================================
# @timeout 300000
POST {{baseUrl}}/lipsync
Content-Type: application/json

{
  "video_url": "{{videoUrl}}",
  "audio_url": "{{audioUrl}}",
  "upload_url": "YOUR_PRESIGNED_UPLOAD_URL",
  "characters": [
    {
      "id": "speaker",
      "name": "Speaker",
      "reference_image_url": "{{refImage}}"
    }
  ],
  "similarity_threshold": 0.5,
  "enhance_quality": true,
  "loop_mode": "repeat",
  "temporal_smoothing": 0.3
}

### =============================================================================
### Lip-Sync - No Enhancement (Faster, Lower Quality)
### Skip GFPGAN for faster processing
### =============================================================================
# @timeout 180000
POST {{baseUrl}}/lipsync
Content-Type: application/json

{
  "video_url": "{{videoUrl}}",
  "audio_url": "{{audioUrl}}",
  "upload_url": "YOUR_PRESIGNED_UPLOAD_URL",
  "characters": [
    {
      "id": "speaker",
      "name": "Speaker",
      "reference_image_url": "{{refImage}}"
    }
  ],
  "similarity_threshold": 0.5,
  "enhance_quality": false,
  "loop_mode": "crossfade",
  "temporal_smoothing": 0.3
}

### =============================================================================
### Lip-Sync - Multiple Characters
### =============================================================================
# @timeout 300000
POST {{baseUrl}}/lipsync
Content-Type: application/json

{
  "video_url": "{{videoUrl}}",
  "audio_url": "{{audioUrl}}",
  "upload_url": "YOUR_PRESIGNED_UPLOAD_URL",
  "characters": [
    {
      "id": "char_1",
      "name": "Character 1",
      "reference_image_url": "https://example.com/char1.jpg"
    },
    {
      "id": "char_2",
      "name": "Character 2",
      "reference_image_url": "https://example.com/char2.jpg"
    }
  ],
  "similarity_threshold": 0.5,
  "enhance_quality": true,
  "loop_mode": "crossfade",
  "crossfade_frames": 10,
  "temporal_smoothing": 0.3
}
